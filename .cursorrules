---
description: "Guía de desarrollo Backend (Laravel) para Zonix Eats"
alwaysApply: true
---

## Instrucciones Completas

Para instrucciones completas del proyecto, arquitectura, convenciones, skills disponibles
y reglas de negocio, consulta el archivo `AGENTS.md` en la raíz del proyecto.

Cursor lee `AGENTS.md` automáticamente. Toda la información de desarrollo está centralizada allí.

---

## Reglas de Colaboración (Cursor-Específicas)

**IMPORTANTE: El usuario es el líder del proyecto. No soy un autómata que ejecuta sin pensar.**

1. **SIEMPRE PREGUNTAR** antes de realizar cualquier acción
2. **NUNCA crear archivos nuevos** si es para editar código existente
3. **SIEMPRE sugerir detalladamente** qué hacer y esperar aprobación
4. **NUNCA hacer push/merge a git** sin orden explícita del usuario
5. **Solo hacer commits locales** cuando se realicen cambios
6. **El usuario prueba primero** y da la orden cuando está seguro

### Convención de Respuesta

```
1. Explicar qué se va a hacer y por qué
2. Mostrar código específico con contexto
3. Esperar confirmación antes de implementar
4. Reportar resultado después de implementar
```

---

## Recordatorios Rápidos (Ver AGENTS.md para detalles)

### Stack
- **Laravel 10.x** / PHP 8.1+ / MySQL
- **Sanctum** para autenticación
- **Pusher + FCM** para eventos (NO WebSocket)

### Roles (Solo 4 — Terminología Estándar)

| Código en BD | Nombre Estándar | Alias aceptados          |
| ------------ | --------------- | ------------------------ |
| `users`      | **Buyer**       | Comprador, Cliente       |
| `commerce`   | **Commerce**    | Comercio, Restaurante    |
| `delivery`   | **Delivery**    | Delivery Agent, Repartidor |
| `admin`      | **Admin**       | Administrador            |

### Patrón de Respuesta API
```php
return response()->json([
    'success' => true|false,
    'data' => $data,
    'message' => 'mensaje'
], $statusCode);
```

### Reglas Clave
- Lógica de negocio en **Services**, NO en Controllers
- SIEMPRE `with()` para eager loading (evitar N+1)
- SIEMPRE Form Requests para validación
- SIEMPRE `DB::transaction()` para operaciones críticas
- Uploads: max 5MB, solo tipos permitidos
- SIEMPRE paginar listados

### Skills de dominio recomendadas

- **zonix-api-patterns**: para crear o modificar endpoints, controladores, rutas y middleware (`routes/api.php`, `app/Http/Controllers`, `app/Http/Middleware`).
- **zonix-order-lifecycle**: para cualquier cambio en órdenes, estados, cancelaciones o reglas de flujo de pedido.
- **zonix-delivery-system**: para lógica de geolocalización, Haversine, OSRM, zonas de entrega y tracking de delivery.
- **zonix-realtime-events**: para eventos broadcast, Pusher, FCM, canales y notificaciones en tiempo real.
- **zonix-payments**: para comisiones, delivery_fee, totales y reglas de negocio de pagos.

### Tests
```bash
php artisan test                      # Todos (206+)
php artisan test --filter=NombreTest  # Específico
```

---

**Última actualización:** 25 Febrero 2026
**Para instrucciones completas:** Ver `AGENTS.md`
